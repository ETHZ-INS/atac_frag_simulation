---
title: "test_simulations"
output: html_document
date: '2023-02-21'
---



# Get ATAC Peaks on pooled Samples

If `--nomodel --extsize 200` not specified, error is obtained (too few paired peaks (0)). 
Haven't checked yet but see:   
* https://github.com/macs3-project/MACS/issues/390
* https://github.com/macs3-project/MACS/issues/353

es stands for effect size
```{bash engine.opts='-l', eval=TRUE}
mkdir -p ./sim_data/peaks
for es in 0, 0.5 , 1 , 2 , 3
do
  macs2 callpeak --outdir ./sim_data_demo -f BED -t ./sim_data_demo/"mergedSamples_lfc_based_${es}.bed" --outdir ./sim_data_demo/peaks -n "mergedSamples_peaks_${es}" --nomodel --extsize 200
done
```

# Get ATAC peaks for single samples

```{bash engine.opts='-l', eval=TRUE}
#mkdir -p ./sim_data/peaks
for es in 0, 0.5 , 1 , 2 , 3
do
 for sample in 1 , 2 , 3 , 4 , 5 , 6
  do 
    echo "sample${sample}_${es}.bed"
    macs2 callpeak -f BED -t ./sim_data_demo/"sample${sample}_lfc_based_${es}.bed" --outdir ./sim_data_demo/peaks -n "sample${sample}_${es}_peaks" --nomodel --extsize 200
  done
done
```